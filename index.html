<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Top-Down Car Game</title>
<style>
    body { margin: 0; background: black; overflow: hidden; }
    canvas { display: block; }
</style>
</head>
<body>
<canvas id="game"></canvas>
<script>
// Canvas setup
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// Macchina
let car = { x: 0, y: 0, angle: 0, speed: 0 };
const keys = {};

// Eventi tasti
window.addEventListener("keydown", e => {
    keys[e.key] = true;
    if (e.key === " ") changeTrack(); // cambia pista con SPAZIO
});
window.addEventListener("keyup", e => keys[e.key] = false);

// Circuiti (immagini)
const trackImages = [];
let currentTrack = 0;

// Carica 5 immagini di esempio (puoi cambiarle con piste reali)
for (let i = 1; i <= 5; i++) {
    let img = new Image();
    img.src = `https://picsum.photos/seed/track${i}/2000/2000`; // immagini random 2000x2000
    trackImages.push(img);
}

function changeTrack() {
    currentTrack = (currentTrack + 1) % trackImages.length;
    car.x = 0;
    car.y = 0;
    car.angle = 0;
    car.speed = 0;
}

function update() {
    if (keys["ArrowUp"]) car.speed += 0.2;
    if (keys["ArrowDown"]) car.speed -= 0.2;
    if (keys["ArrowLeft"]) car.angle -= 0.05;
    if (keys["ArrowRight"]) car.angle += 0.05;

    car.x += Math.cos(car.angle) * car.speed;
    car.y += Math.sin(car.angle) * car.speed;
    car.speed *= 0.98; // attrito
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    ctx.save();
    // Telecamera segue e ruota con lâ€™auto
    ctx.translate(canvas.width / 2, canvas.height / 2);
    ctx.rotate(-car.angle);
    ctx.translate(-car.x, -car.y);

    // Sfondo (pista attuale)
    let track = trackImages[currentTrack];
    if (track.complete) {
        ctx.drawImage(track, -1000, -1000, 2000, 2000);
    }

    // Macchina
    ctx.save();
    ctx.translate(car.x, car.y);
    ctx.rotate(car.angle);
    ctx.fillStyle = "red";
    ctx.fillRect(-15, -10, 30, 20);
    ctx.restore();

    ctx.restore();
}

function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
